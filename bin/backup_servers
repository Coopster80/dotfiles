#!/bin/bash

backup () {
	local user=$1
	local host=$2
	local source=$3
	local destination=$4
	local filename=$5
	if ssh -q ${host} [[ -f "${destination}/${filename}" ]]
	then
		echo "${source} backup for today already complete"
	else
		tar cf - -C "${HOME}" "${source}" | lz4 -1 - | ssh "${user}@${host}" dd of="${destination}/${filename}"
	fi
}

backup barrelmaker pollux "mc-servers" "/mnt/Backup/mc-servers" "mc-servers-$(date +%m-%d-%Y).lz4"
backup barrelmaker pollux "factorio-servers" "/mnt/Backup/factorio-servers" "factorio-servers-$(date +%m-%d-%Y).lz4"
